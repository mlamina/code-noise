{% extends "base.html.jinja2" %}

{% block title %}Volume Control{% endblock %}

{% block content %}
    <section class="section">
        <div class="container">
            <h2 class="title">YouTube Video Volume Control</h2>
            <div class="columns is-multiline">
                <div class="column is-one-quarter">
                    <div class="box">
                        <h3 class="subtitle">YouTube Video</h3>
                        <div class="field">
                            <iframe id="youtube-player" width="100%" height="200" src="https://www.youtube.com/embed/Nep1qytq9JM" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                        </div>
                        <div class="field">
                            <label class="label" for="youtube-volume">Volume:</label>
                            <div class="control">
                                <input class="slider is-fullwidth" type="range" id="youtube-volume" name="youtube-volume" min="0" max="100" step="1" value="50">
                            </div>
                        </div>
                        <div class="field">
                            <div class="control">
                                <button class="button is-link" id="youtube-toggle">Play</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <script>
        let youtubePlayer;
        function onYouTubeIframeAPIReady() {
            youtubePlayer = new YT.Player('youtube-player', {
                events: {
                    'onReady': onPlayerReady
                }
            });
        }

        function onPlayerReady(event) {
            document.getElementById('youtube-toggle').addEventListener('click', function() {
                if (youtubePlayer.getPlayerState() === YT.PlayerState.PLAYING) {
                    youtubePlayer.pauseVideo();
                    document.getElementById('youtube-toggle').innerText = 'Play';
                } else {
                    youtubePlayer.playVideo();
                    document.getElementById('youtube-toggle').innerText = 'Stop';
                }
            });

            document.getElementById('youtube-volume').addEventListener('input', function() {
                youtubePlayer.setVolume(this.value);
            });
        }

        var tag = document.createElement('script');
        tag.src = "https://www.youtube.com/iframe_api";
        var firstScriptTag = document.getElementsByTagName('script')[0];
        firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
    </script>
{% endblock %}