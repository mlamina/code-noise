{% extends "base.html.jinja2" %}

{% block title %}Home{% endblock %}

{% block content %}
    <h2>Background Noise Generator</h2>
    <div>
        <label for="volume">Volume:</label>
        <input type="range" id="volume" name="volume" min="0" max="1" step="0.01" value="0.5">
    </div>
    <div>
        <label for="frequency">Frequency:</label>
        <input type="range" id="frequency" name="frequency" min="20" max="20000" step="1" value="440">
    </div>
    <button id="play">Play</button>
    <button id="stop">Stop</button>

    <script>
        let audioContext = new (window.AudioContext || window.webkitAudioContext)();
        let oscillator;
        let gainNode = audioContext.createGain();

        document.getElementById('play').addEventListener('click', function() {
            oscillator = audioContext.createOscillator();
            oscillator.type = 'white'; // white noise
            oscillator.frequency.setValueAtTime(document.getElementById('frequency').value, audioContext.currentTime);
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            gainNode.gain.setValueAtTime(document.getElementById('volume').value, audioContext.currentTime);
            oscillator.start();
        });

        document.getElementById('stop').addEventListener('click', function() {
            if (oscillator) {
                oscillator.stop();
                oscillator.disconnect();
            }
        });

        document.getElementById('volume').addEventListener('input', function() {
            gainNode.gain.setValueAtTime(this.value, audioContext.currentTime);
        });

        document.getElementById('frequency').addEventListener('input', function() {
            if (oscillator) {
                oscillator.frequency.setValueAtTime(this.value, audioContext.currentTime);
            }
        });
    </script>
{% endblock %}
